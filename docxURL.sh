#!/bin/bash

#------
#Version 0.1
#Author: Github@MasterEvarior
#Just a little script that searches all the urls and ips in a docx file
#------



#Function to extract the urls
function getURL(){
  echo "-URLs----------------"
  grep -ri http temp_docXX/ | sed -E 's/http/\rhttp/g' | egrep -o "https?://[^\"]*" | sort | uniq 
echo "-IPs----------------"
}

#Function to extract the ips
function getIP(){
  grep -r -E -o "([0-9]{1,3}[\.]){3}[0-9]{1,3}"  temp_docXX/ | sort | uniq
  echo "-------------------"
}


echo "Unzipping files..."
echo "Extracting..."

for var in "$@"
do
echo "Working on $var..."
mkdir temp_docXX
  unzip -qq $var  -d temp_docXX/

  getURL
  getIP

  rm -rf temp_docXX
done
echo "Removing unzipped files..."
echo "Done"
